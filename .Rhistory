data_table_out <- mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
)
sqldf2_where_compiled <- cmpfun(sqldf2_where)
microbenchmark(times=500,
#sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_compiled_out <- sqldf2_where_compiled("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_stringi_out <- sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf_where_out <- sqldf("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
dplyr_out <- mtcars %>%
dplyr::filter(disp >= 200) %>%
dplyr::select(mpg,cyl),
monetdblite_where_out <- dbGetQuery(con, "SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
data_table_out <- mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
)
library(dplyr)
library(microbenchmark)
#library(data.table)
library(sqldf)
library(Rcpp)
library(stringi)
library(compiler)
library(MonetDBLite)
library(DBI)
library(data.table)
# Load some data
data(mtcars)
# MonetDBList table initialisation
con <- dbConnect(MonetDBLite::MonetDBLite())
dbWriteTable(con, "mtcars", mtcars, overwrite = TRUE)
# Inline Rcpp function for comparison
cppFunction('List select_out(List x, CharacterVector y) {
return x[y];
}')
mtcars_data_table <- data.table(mtcars)
sqldf2_where <- function(query){
querySub <- stri_replace_all_fixed(query,
c("SELECT", "FROM", "WHERE"), c("SELECT:", ":FROM:", ":WHERE:"), vectorize_all=FALSE)
querySplit <- stri_split_fixed(querySub, ":", omit_empty=TRUE)
querySplit <- trimws(unlist(querySplit))
select_cols <- stri_split_fixed(querySplit[2], ",")[[1]]
select_cols <- trimws(select_cols)
where_calc <- stri_split_fixed(querySplit[6], ",")[[1]]
where_calc <- trimws(where_calc)
queryDf <- eval(parse(text = querySplit[4]))
queryDf_where <- paste(querySplit[4],"$",where_calc, sep="")
queryDf_where <- eval(parse(text = queryDf_where))
where_df <- as.data.frame(queryDf[queryDf_where,])
as.data.frame(where_df[c(select_cols)])
}
sqldf2_where_compiled <- cmpfun(sqldf2_where)
sqldf2_where_cpp <- function(query){
querySub <- stri_replace_all_fixed(query,
c("SELECT", "FROM", "WHERE"), c("SELECT:", ":FROM:", ":WHERE:"), vectorize_all=FALSE)
querySplit <- stri_split_fixed(querySub, ":", omit_empty=TRUE)
querySplit <- trimws(unlist(querySplit))
select_cols <- stri_split_fixed(querySplit[2], ",")[[1]]
select_cols <- trimws(select_cols)
where_calc <- stri_split_fixed(querySplit[6], ",")[[1]]
where_calc <- trimws(where_calc)
queryDf <- eval(parse(text = querySplit[4]))
queryDf_where <- paste(querySplit[4],"$",where_calc, sep="")
queryDf_where <- eval(parse(text = queryDf_where))
where_df <- as.data.frame(queryDf[queryDf_where,])
#as.data.frame(where_df[c(select_cols)])
# Run Rcpp function
select_out(where_df, c(select_cols))
}
microbenchmark(times=500,
#sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_compiled_out <- sqldf2_where_compiled("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_stringi_out <- sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf_where_out <- sqldf("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
dplyr_out <- mtcars %>%
dplyr::filter(disp >= 200) %>%
dplyr::select(mpg,cyl),
monetdblite_where_out <- dbGetQuery(con, "SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
data_table_out <- mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
)
sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
library(dplyr)
library(microbenchmark)
#library(data.table)
library(sqldf)
library(Rcpp)
library(stringi)
library(compiler)
library(MonetDBLite)
library(DBI)
library(data.table)
# Load some data
data(mtcars)
# MonetDBList table initialisation
con <- dbConnect(MonetDBLite::MonetDBLite())
dbWriteTable(con, "mtcars", mtcars, overwrite = TRUE)
# Inline Rcpp function for comparison
cppFunction('List select_out(List x, CharacterVector y) {
return x[y];
}')
mtcars_data_table <- data.table(mtcars)
sqldf2_where <- function(query){
querySub <- stri_replace_all_fixed(query,
c("SELECT", "FROM", "WHERE"), c("SELECT:", ":FROM:", ":WHERE:"), vectorize_all=FALSE)
querySplit <- stri_split_fixed(querySub, ":", omit_empty=TRUE)
querySplit <- trimws(unlist(querySplit))
select_cols <- stri_split_fixed(querySplit[2], ",")[[1]]
select_cols <- trimws(select_cols)
where_calc <- stri_split_fixed(querySplit[6], ",")[[1]]
where_calc <- trimws(where_calc)
queryDf <- eval(parse(text = querySplit[4]))
queryDf_where <- paste(querySplit[4],"$",where_calc, sep="")
queryDf_where <- eval(parse(text = queryDf_where))
where_df <- as.data.frame(queryDf[queryDf_where,])
as.data.frame(where_df[c(select_cols)])
}
sqldf2_where_compiled <- cmpfun(sqldf2_where)
sqldf2_where_cpp <- function(query){
querySub <- stri_replace_all_fixed(query,
c("SELECT", "FROM", "WHERE"), c("SELECT:", ":FROM:", ":WHERE:"), vectorize_all=FALSE)
querySplit <- stri_split_fixed(querySub, ":", omit_empty=TRUE)
querySplit <- trimws(unlist(querySplit))
select_cols <- stri_split_fixed(querySplit[2], ",")[[1]]
select_cols <- trimws(select_cols)
where_calc <- stri_split_fixed(querySplit[6], ",")[[1]]
where_calc <- trimws(where_calc)
queryDf <- eval(parse(text = querySplit[4]))
queryDf_where <- paste(querySplit[4],"$",where_calc, sep="")
queryDf_where <- eval(parse(text = queryDf_where))
where_df <- as.data.frame(queryDf[queryDf_where,])
#as.data.frame(where_df[c(select_cols)])
# Run Rcpp function
select_out(where_df, c(select_cols))
}
microbenchmark(times=500,
#sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_compiled_out <- sqldf2_where_compiled("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_stringi_out <- sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf_where_out <- sqldf("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
dplyr_out <- mtcars %>%
dplyr::filter(disp >= 200) %>%
dplyr::select(mpg,cyl),
monetdblite_where_out <- dbGetQuery(con, "SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
data_table_out <- mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
)
microbenchmark(times=1,
#sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_compiled_out <- sqldf2_where_compiled("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_stringi_out <- sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf_where_out <- sqldf("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
dplyr_out <- mtcars %>%
dplyr::filter(disp >= 200) %>%
dplyr::select(mpg,cyl),
monetdblite_where_out <- dbGetQuery(con, "SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
data_table_out <- mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
)
microbenchmark(times=1000,
#sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_compiled_out <- sqldf2_where_compiled("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_stringi_out <- sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf2_where_cpp_out <- sqldf2_where_cpp("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
sqldf_where_out <- sqldf("SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
dplyr_out <- mtcars %>%
dplyr::filter(disp >= 200) %>%
dplyr::select(mpg,cyl),
monetdblite_where_out <- dbGetQuery(con, "SELECT mpg, cyl FROM mtcars WHERE disp >= 200"),
data_table_out <- mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
)
sqldf2_where("SELECT mpg, cyl FROM mtcars")
query <- paste("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
query
querySub <- stri_replace_all_fixed(query,
c("SELECT", "FROM", "WHERE"), c("SELECT:", ":FROM:", ":WHERE:"), vectorize_all=FALSE)
querySub
querySplit <- stri_split_fixed(querySub, ":", omit_empty=TRUE)
querySplit
querySplit <- trimws(unlist(querySplit))
querySplit
select_cols <- stri_split_fixed(querySplit[2], ",")[[1]]
select_cols
select_cols <- trimws(select_cols)
select_cols
where_calc <- stri_split_fixed(querySplit[6], ",")[[1]]
where_calc
where_calc <- trimws(where_calc)
where_calc
queryDf <- eval(parse(text = querySplit[4]))
queryDf
querySplit[4]
querySplit
queryDf_where <- eval(parse(text = queryDf_where))
queryDf_where <- paste(querySplit[4],"$",where_calc, sep="")
queryDf_where
queryDf_where <- eval(parse(text = queryDf_where))
queryDf_where
where_df <- as.data.frame(queryDf[queryDf_where,])
where_df
as.data.frame(where_df[c(select_cols)])
queryDf_where
queryDf[queryDf_where,]
querySplit[2]
select_cols <- trimws(select_cols)
select_cols
select_cols
c(select_cols)
mtcars_data_table[disp >= 200, c(select_cols),]
mtcars_data_table[disp >= 200, c(select_cols),]
mtcars_data_table
select_cols
c(select_cols)
mtcars_data_table[disp >= 200, c(select_cols),]
queryDf_where
queryDf
where_calc
mtcars_data_table[where_calc, c(select_cols),]
mtcars_data_table <- data.table(mtcars)
mtcars_data_table
mtcars_data_table[where_calc, c(select_cols),]
where_calc
where_df
queryDf_where
mtcars_data_table[eval(parse(text = where_calc)), c(select_cols),]
mtcars_data_table[eval(parse(text = where_calc)), c(eval(parse(text = select_cols))),]
c(eval(parse(text = select_cols)))
eval(parse(text = where_calc))
eval(parse(text = where_calc))
where_calc
paste(querySplit[4],"$",where_calc, sep="")
eval(parse(text = queryDf_where))
str(where_calc)
paste(where_calc, spe = "")
paste(where_calc, sep = "")
paste(select_cols, sep="")
mtcars_data_table[paste(where_calc, sep = ""), c(paste(select_cols, sep=""),]
mtcars_data_table[paste(where_calc, sep = ""),]
paste(select_cols, sep="")
c(select_cols)
c(select_cols)
mtcars_data_table[paste(where_calc, sep = ""), c(select_cols),]
select_cols
select_cols[1]
c(select_cols[1], select_cols[2])
mtcars_data_table[paste(where_calc, sep = ""), c(select_cols[1], select_cols[2]),]
where_df
queryDf_where
queryDf
where_calc
str(where_calc)
mtcars_data_table[eval(parse(text = where_calc)), c(select_cols[1], select_cols[2]),]
select_cols[1]
eval(parse(text = where_calc))
mtcars_data_table
c(select_cols[1], select_cols[2])
mtcars_data_table[eval(parse(text = where_calc)), c(eval(parse(text = select_cols[1])), eval(parse(text = select_cols[2]))),]
sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
c(eval(parse(text = select_cols[1])), eval(parse(text = select_cols[2])))
table_test <- mtcars_data_table[eval(parse(text = where_calc)), c(eval(parse(text = select_cols[1])), eval(parse(text = select_cols[2]))),]
table_test
str(table_text)
str(table_test)
mtcars_data_table[disp >= 200, c("mpg", "cyl"),]
sqldf("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
sqldf2_where("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
dbGetQuery(con, "SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
sqldf2_where_compiled("SELECT mpg, cyl FROM mtcars WHERE disp >= 200")
mtcars %>%
dplyr::filter(disp >= 200) %>%
dplyr::select(mpg,cyl)
querySub <- stri_replace_all_fixed(query,
c("SELECT", "FROM", "WHERE"), c("SELECT:", ":FROM:", ":WHERE:"), vectorize_all=FALSE)
querySplit <- stri_split_fixed(querySub, ":", omit_empty=TRUE)
querySplit <- trimws(unlist(querySplit))
select_cols <- stri_split_fixed(querySplit[2], ",")[[1]]
select_cols <- trimws(select_cols)
where_calc <- stri_split_fixed(querySplit[6], ",")[[1]]
where_calc <- trimws(where_calc)
queryDf <- eval(parse(text = querySplit[4]))
queryDf_where <- paste(querySplit[4],"$",where_calc, sep="")
queryDf_where <- eval(parse(text = queryDf_where))
where_df <- as.data.frame(queryDf[queryDf_where,])
as.data.frame(where_df[c(select_cols)])
as.data.frame(queryDf[queryDf_where,])
install.packages("dplyr")
library(dplyr)
library(knitr)
# Betting P&L
PnL <- data.frame(matrix(ncol = 9, nrow = 0))
cols <- c("date", "start_time", "track", "race_type", "horse", "bet_size", "result", "payout", "points_return")
colnames(PnL) <- cols
# Add bet function
add_bet <- function(date, start_time, track, race_type, horse, bet_size, result, payout){
ifelse(result == 0, points_return <- -1*abs(bet_size / 5), points_return <- payout / 5)
PnL[nrow(PnL) + 1,] = list(date,start_time, track, horse, race_type, bet_size, result, payout, points_return)
PnL
}
# Enter all the runners
PnL <- add_bet("2019-04-26", "13:40", "Doncaster", "Flat", "Felix", 5, 0, 0)
PnL <- add_bet("2019-04-26", "15:00", "Sandown", "Flat", "Persian Moon", 5, 0, 0)
PnL <- add_bet("2019-04-26", "00:00", "Sandown", "Flat", "Doubles and Treble", 4, 0, 0)
PnL <- add_bet("2019-04-27", "13:40", "Leicester", "Flat", "Last Page", 5, 1, 36.11)
PnL <- add_bet("2019-04-27", "15:25", "Leicester", "Flat", "Cape Islay", 5, 0, 0)
PnL <- add_bet("2019-04-27", "15:15", "Haydock", "Flat", "Thanks Be", 2.5, 0, 0)
PnL <- add_bet("2019-04-27", "16:35", "Ripon", "Flat", "Asad", 10, 0, 0)
PnL <- add_bet("2019-04-27", "16:50", "Haydock", "Flat", "Ledham", 5, 0, 0)
PnL <- add_bet("2019-04-27", "17:00", "Leicester", "Flat", "Laafy", 5, 1, 29.80)
PnL <- add_bet("2019-04-27", "19:45", "Doncaster", "Flat", "Florenza", 5, 1, 19.00)
PnL <- add_bet("2019-04-27", "20:30", "Wolverhampton", "AW", "Emirates Knight", 5, 0, 0)
PnL <- add_bet("2019-04-28", "15:35", "Salisbury", "Flat", "Mayfair Spirit", 5, 1, 21.55)
PnL <- add_bet("2019-04-28", "16:15", "Navan", "Flat", "Twilight Payment", 5, 0, 0)
PnL <- add_bet("2019-04-29", "14:00", "Wolverhampton", "AW", "Miss Enigma", 5, 1, 20.42)
PnL <- add_bet("2019-04-29", "16:25", "Newcastle", "Flat", "Trevithick", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:20", "Naas", "Flat", "Ardhoomey", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:30", "Windsor", "Flat", "Just Brilliant", 10, 0, 0)
PnL <- add_bet("2019-04-29", "19:40", "Thirsk", "Flat", "Nevada", 5, 0, 0)
PnL <- add_bet("2019-04-30", "15:05", "Nottingham", "Flat", "Kings Girl", 5, 0, 0)
PnL <- add_bet("2019-04-30", "16:05", "Nottingham", "Flat", "Queen Constantine", 5, 0, 0)
PnL <- add_bet("2019-04-30", "17:45", "Chelmsford", "AW", "Fantastic Flyer", 5, 1, 19.47)
PnL <- add_bet("2019-04-30", "18:55", "Chelmsford", "AW", "Field Gun", 5, 0, 0)
PnL <- add_bet("2019-05-01", "14:35", "Southwell", "AW", "Lauras Legacy", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:25", "Ascot", "Flat", "Danehill Kodiac", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:35", "Pontefract", "Flat", "Ronnie the Rooster", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:10", "Pontefract", "Flat", "Mount Ararat", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:25", "Ascot", "Flat", "Tabarrak", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:50", "Bath", "Flat", "Whataguy", 5, 0, 0)
PnL <- add_bet("2019-05-02", "14:45", "Musselburgh", "Flat", "Apterix", 5, 1, 24.07)
PnL <- add_bet("2019-05-02", "16:25", "Musselburgh", "Flat", "Hippeia", 5, 0, 0)
PnL <- add_bet("2019-05-02", "16:45", "Southwell", "AW", "Zorros Girl", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:20", "Chelmsford", "AW", "Smarter", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:30", "Salisbury", "Flat", "Fourty Four Sunsets", 5, 0, 0)
PnL <- add_bet("2019-05-03", "13:35", "Lingfield", "AW", "She Believes", 5, 1, 37.05)
PnL <- add_bet("2019-05-03", "15:15", "Chepstow", "Flat", "Plumette", 5, 1, 25.65)
PnL <- add_bet("2019-05-03", "00:00", "Chepstow", "Flat", "Forecast", 2.5, 0, 0)
PnL <- add_bet("2019-05-03", "16:45", "Lingfield", "AW", "Aristocratic Lady", 5, 0, 0)
PnL <- add_bet("2019-05-03", "20:00", "Newcastle", "Flat", "Gallipoli", 5, 0, 0)
PnL <- add_bet("2019-05-04", "14:20", "Newmarket", "Flat", "Mabs Cross", 5, 1, 31.35)
PnL <- add_bet("2019-05-04", "14:55", "Newmarket", "Flat", "Coronet", 10, 0, 0)
PnL <- add_bet("2019-05-04", "15:35", "Newmarket", "Flat", "Advertise", 10, 0, 0)
PnL <- add_bet("2019-05-04", "00:00", "Newmarket", "Flat", "Placepot", 12.2, 0, 0)
PnL <- add_bet("2019-05-04", "17:30", "Goodwood", "Flat", "Htilominlo", 5, 0, 0)
PnL <- add_bet("2019-05-05", "14:20", "Newmarket", "Flat", "Nyaleti", 5, 0, 0)
PnL <- add_bet("2019-05-05", "15:20", "Gowran Park", "Flat", "Could be King", 10, 0, 0)
PnL <- add_bet("2019-05-05", "16:45", "Newmarket", "Flat", "Shambolic", 5, 0, 0)
PnL <- add_bet("2019-05-06", "15:00", "Curragh", "Flat", "Eclipse Storm", 5, 0, 0)
PnL <- add_bet("2019-05-06", "15:25", "Bath", "Flat", "Sky Defender", 5, 1, 21.85)
PnL <- add_bet("2019-05-06", "15:35", "Curragh", "Flat", "Indian Blessing", 5, 0, 0)
PnL <- add_bet("2019-05-06", "15:45", "Windsor", "Flat", "Grapevine", 5, 0, 0)
PnL <- add_bet("2019-05-07", "19:00", "Wolverhampton", "AW", "Cappananty Con", 5, 1, 17.86)
PnL <- add_bet("2019-05-07", "20:00", "Wolverhampton", "AW", "Sea of Marengo", 5, 0, 0)
PnL <- add_bet("2019-05-08", "13:50", "Chester", "Flat", "Great Dame", 5, 1, 17.40)
PnL <- add_bet("2019-05-08", "14:25", "Chester", "Flat", "Manuela De Vega", 5, 0, 0)
PnL <- add_bet("2019-05-08", "15:35", "Chester", "Flat", "Kaloor", 5, 0, 0)
PnL <- add_bet("2019-05-08", "19:35", "Southwell", "AW", "Glutnforpunishment", 5, 1, 22.70)
PnL <- add_bet("2019-05-09", "15:35", "Chester", "Flat", "Morando", 5, 1, 20)
PnL <- add_bet("2019-05-09", "20:00", "Chelmsford", "AW", "Kodiac Harbour", 5, 0, 0)
PnL <- add_bet("2019-05-10", "18:50", "Nottingham", "Flat", "Patchouli", 5, 0, 0)
PnL <- add_bet("2019-05-10", "17:40", "Wolverhampton", "AW", "Miss Enigma", 5, 0, 0)
View(PnL)
PnL <- add_bet("2019-04-26", "13:40", "Doncaster", "Flat", "Felix", 5, 0, 0)
PnL <- add_bet("2019-04-26", "15:00", "Sandown", "Flat", "Persian Moon", 5, 0, 0)
PnL <- add_bet("2019-04-26", "00:00", "Sandown", "Flat", "Doubles and Treble", 4, 0, 0)
PnL <- add_bet("2019-04-27", "13:40", "Leicester", "Flat", "Last Page", 5, 1, 36.11)
PnL <- add_bet("2019-04-27", "15:25", "Leicester", "Flat", "Cape Islay", 5, 0, 0)
PnL <- add_bet("2019-04-27", "15:15", "Haydock", "Flat", "Thanks Be", 2.5, 0, 0)
PnL <- add_bet("2019-04-27", "16:35", "Ripon", "Flat", "Asad", 10, 0, 0)
PnL <- add_bet("2019-04-27", "16:50", "Haydock", "Flat", "Ledham", 5, 0, 0)
PnL <- add_bet("2019-04-27", "17:00", "Leicester", "Flat", "Laafy", 5, 1, 29.80)
PnL <- add_bet("2019-04-27", "19:45", "Doncaster", "Flat", "Florenza", 5, 1, 19.00)
PnL <- add_bet("2019-04-27", "20:30", "Wolverhampton", "AW", "Emirates Knight", 5, 0, 0)
PnL <- add_bet("2019-04-28", "15:35", "Salisbury", "Flat", "Mayfair Spirit", 5, 1, 21.55)
PnL <- add_bet("2019-04-28", "16:15", "Navan", "Flat", "Twilight Payment", 5, 0, 0)
PnL <- add_bet("2019-04-29", "14:00", "Wolverhampton", "AW", "Miss Enigma", 5, 1, 20.42)
PnL <- add_bet("2019-04-29", "16:25", "Newcastle", "Flat", "Trevithick", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:20", "Naas", "Flat", "Ardhoomey", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:30", "Windsor", "Flat", "Just Brilliant", 10, 0, 0)
PnL <- add_bet("2019-04-29", "19:40", "Thirsk", "Flat", "Nevada", 5, 0, 0)
PnL <- add_bet("2019-04-30", "15:05", "Nottingham", "Flat", "Kings Girl", 5, 0, 0)
PnL <- add_bet("2019-04-30", "16:05", "Nottingham", "Flat", "Queen Constantine", 5, 0, 0)
PnL <- add_bet("2019-04-30", "17:45", "Chelmsford", "AW", "Fantastic Flyer", 5, 1, 19.47)
PnL <- add_bet("2019-04-30", "18:55", "Chelmsford", "AW", "Field Gun", 5, 0, 0)
PnL <- add_bet("2019-05-01", "14:35", "Southwell", "AW", "Lauras Legacy", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:25", "Ascot", "Flat", "Danehill Kodiac", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:35", "Pontefract", "Flat", "Ronnie the Rooster", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:10", "Pontefract", "Flat", "Mount Ararat", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:25", "Ascot", "Flat", "Tabarrak", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:50", "Bath", "Flat", "Whataguy", 5, 0, 0)
PnL <- add_bet("2019-05-02", "14:45", "Musselburgh", "Flat", "Apterix", 5, 1, 24.07)
PnL <- add_bet("2019-05-02", "16:25", "Musselburgh", "Flat", "Hippeia", 5, 0, 0)
PnL <- add_bet("2019-05-02", "16:45", "Southwell", "AW", "Zorros Girl", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:20", "Chelmsford", "AW", "Smarter", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:30", "Salisbury", "Flat", "Fourty Four Sunsets", 5, 0, 0)
library(dplyr)
library(knitr)
# Betting P&L
PnL <- data.frame(matrix(ncol = 9, nrow = 0))
cols <- c("date", "start_time", "track", "race_type", "horse", "bet_size", "result", "payout", "points_return")
colnames(PnL) <- cols
# Add bet function
add_bet <- function(date, start_time, track, race_type, horse, bet_size, result, payout){
ifelse(result == 0, points_return <- -1*abs(bet_size / 5), points_return <- payout / 5)
PnL[nrow(PnL) + 1,] = list(date,start_time, track, horse, race_type, bet_size, result, payout, points_return)
PnL
}
PnL <- add_bet("2019-04-26", "13:40", "Doncaster", "Flat", "Felix", 5, 0, 0)
PnL <- add_bet("2019-04-26", "15:00", "Sandown", "Flat", "Persian Moon", 5, 0, 0)
PnL <- add_bet("2019-04-26", "00:00", "Sandown", "Flat", "Doubles and Treble", 4, 0, 0)
PnL <- add_bet("2019-04-27", "13:40", "Leicester", "Flat", "Last Page", 5, 1, 36.11)
PnL <- add_bet("2019-04-27", "15:25", "Leicester", "Flat", "Cape Islay", 5, 0, 0)
PnL <- add_bet("2019-04-27", "15:15", "Haydock", "Flat", "Thanks Be", 2.5, 0, 0)
PnL <- add_bet("2019-04-27", "16:35", "Ripon", "Flat", "Asad", 10, 0, 0)
PnL <- add_bet("2019-04-27", "16:50", "Haydock", "Flat", "Ledham", 5, 0, 0)
PnL <- add_bet("2019-04-27", "17:00", "Leicester", "Flat", "Laafy", 5, 1, 29.80)
PnL <- add_bet("2019-04-27", "19:45", "Doncaster", "Flat", "Florenza", 5, 1, 19.00)
PnL <- add_bet("2019-04-27", "20:30", "Wolverhampton", "AW", "Emirates Knight", 5, 0, 0)
PnL <- add_bet("2019-04-28", "15:35", "Salisbury", "Flat", "Mayfair Spirit", 5, 1, 21.55)
PnL <- add_bet("2019-04-28", "16:15", "Navan", "Flat", "Twilight Payment", 5, 0, 0)
PnL <- add_bet("2019-04-29", "14:00", "Wolverhampton", "AW", "Miss Enigma", 5, 1, 20.42)
PnL <- add_bet("2019-04-29", "16:25", "Newcastle", "Flat", "Trevithick", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:20", "Naas", "Flat", "Ardhoomey", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:30", "Windsor", "Flat", "Just Brilliant", 10, 0, 0)
PnL <- add_bet("2019-04-29", "19:40", "Thirsk", "Flat", "Nevada", 5, 0, 0)
PnL <- add_bet("2019-04-30", "15:05", "Nottingham", "Flat", "Kings Girl", 5, 0, 0)
PnL <- add_bet("2019-04-30", "16:05", "Nottingham", "Flat", "Queen Constantine", 5, 0, 0)
PnL <- add_bet("2019-04-30", "17:45", "Chelmsford", "AW", "Fantastic Flyer", 5, 1, 19.47)
PnL <- add_bet("2019-04-30", "18:55", "Chelmsford", "AW", "Field Gun", 5, 0, 0)
PnL <- add_bet("2019-05-01", "14:35", "Southwell", "AW", "Lauras Legacy", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:25", "Ascot", "Flat", "Danehill Kodiac", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:35", "Pontefract", "Flat", "Ronnie the Rooster", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:10", "Pontefract", "Flat", "Mount Ararat", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:25", "Ascot", "Flat", "Tabarrak", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:50", "Bath", "Flat", "Whataguy", 5, 0, 0)
PnL <- add_bet("2019-05-02", "14:45", "Musselburgh", "Flat", "Apterix", 5, 1, 24.07)
PnL <- add_bet("2019-05-02", "16:25", "Musselburgh", "Flat", "Hippeia", 5, 0, 0)
PnL <- add_bet("2019-05-02", "16:45", "Southwell", "AW", "Zorros Girl", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:20", "Chelmsford", "AW", "Smarter", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:30", "Salisbury", "Flat", "Fourty Four Sunsets", 5, 0, 0)
PnL(date)
View(PnL)
PnL
PnL(date)
PnL[date]
PnL[1]
library(dplyr)
library(knitr)
# Betting P&L
PnL <- data.frame(matrix(ncol = 9, nrow = 0))
cols <- c("date", "start_time", "track", "race_type", "horse", "bet_size", "result", "payout", "points_return")
colnames(PnL) <- cols
# Add bet function
add_bet <- function(date, start_time, track, race_type, horse, bet_size, result, payout){
ifelse(result == 0, points_return <- -1*abs(bet_size / 5), points_return <- payout / 5)
PnL[nrow(PnL) + 1,] = list(date,start_time, track, horse, race_type, bet_size, result, payout, points_return)
PnL
}
PnL <- add_bet("2019-04-26", "13:40", "Doncaster", "Flat", "Felix", 5, 0, 0)
PnL <- add_bet("2019-04-26", "15:00", "Sandown", "Flat", "Persian Moon", 5, 0, 0)
#PnL <- add_bet("2019-04-26", "00:00", "Sandown", "Flat", "Doubles and Treble", 4, 0, 0)
PnL <- add_bet("2019-04-27", "13:40", "Leicester", "Flat", "Last Page", 5, 1, 36.11)
PnL <- add_bet("2019-04-27", "15:25", "Leicester", "Flat", "Cape Islay", 5, 0, 0)
PnL <- add_bet("2019-04-27", "15:15", "Haydock", "Flat", "Thanks Be", 2.5, 0, 0)
PnL <- add_bet("2019-04-27", "16:35", "Ripon", "Flat", "Asad", 10, 0, 0)
PnL <- add_bet("2019-04-27", "16:50", "Haydock", "Flat", "Ledham", 5, 0, 0)
PnL <- add_bet("2019-04-27", "17:00", "Leicester", "Flat", "Laafy", 5, 1, 29.80)
PnL <- add_bet("2019-04-27", "19:45", "Doncaster", "Flat", "Florenza", 5, 1, 19.00)
PnL <- add_bet("2019-04-27", "20:30", "Wolverhampton", "AW", "Emirates Knight", 5, 0, 0)
PnL <- add_bet("2019-04-28", "15:35", "Salisbury", "Flat", "Mayfair Spirit", 5, 1, 21.55)
PnL <- add_bet("2019-04-28", "16:15", "Navan", "Flat", "Twilight Payment", 5, 0, 0)
PnL <- add_bet("2019-04-29", "14:00", "Wolverhampton", "AW", "Miss Enigma", 5, 1, 20.42)
PnL <- add_bet("2019-04-29", "16:25", "Newcastle", "Flat", "Trevithick", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:20", "Naas", "Flat", "Ardhoomey", 5, 0, 0)
PnL <- add_bet("2019-04-29", "18:30", "Windsor", "Flat", "Just Brilliant", 10, 0, 0)
PnL <- add_bet("2019-04-29", "19:40", "Thirsk", "Flat", "Nevada", 5, 0, 0)
PnL <- add_bet("2019-04-30", "15:05", "Nottingham", "Flat", "Kings Girl", 5, 0, 0)
PnL <- add_bet("2019-04-30", "16:05", "Nottingham", "Flat", "Queen Constantine", 5, 0, 0)
PnL <- add_bet("2019-04-30", "17:45", "Chelmsford", "AW", "Fantastic Flyer", 5, 1, 19.47)
PnL <- add_bet("2019-04-30", "18:55", "Chelmsford", "AW", "Field Gun", 5, 0, 0)
PnL <- add_bet("2019-05-01", "14:35", "Southwell", "AW", "Lauras Legacy", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:25", "Ascot", "Flat", "Danehill Kodiac", 5, 0, 0)
PnL <- add_bet("2019-05-01", "15:35", "Pontefract", "Flat", "Ronnie the Rooster", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:10", "Pontefract", "Flat", "Mount Ararat", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:25", "Ascot", "Flat", "Tabarrak", 5, 0, 0)
PnL <- add_bet("2019-05-01", "16:50", "Bath", "Flat", "Whataguy", 5, 0, 0)
PnL <- add_bet("2019-05-02", "14:45", "Musselburgh", "Flat", "Apterix", 5, 1, 24.07)
PnL <- add_bet("2019-05-02", "16:25", "Musselburgh", "Flat", "Hippeia", 5, 0, 0)
PnL <- add_bet("2019-05-02", "16:45", "Southwell", "AW", "Zorros Girl", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:20", "Chelmsford", "AW", "Smarter", 5, 0, 0)
PnL <- add_bet("2019-05-02", "18:30", "Salisbury", "Flat", "Fourty Four Sunsets", 5, 0, 0)
PnL[1]
rev(PnL[1])
sort(PnL[1], decreasing = TRUE)
sort(PnL, decreasing = TRUE)
PnL,
PnL
View(PnL)
PnL[order(date)]
PnL[order(date),]
str(PnL)
PnL[order(PnL[1]),]
PnL[order(-PnL[1]),]
PnL[order(-PnL$date),]
PnL[order(PnL$date),]
PnL[rev(PnL$date),]
rev(PnL$date)
as.list(rev(PnL$date))
rev(PnL$date)
write.csv(PnL, "temp_pnl.csv")
rev(PnL)
sort(PnL)
exit()
q()
setwd("~/Documents/programming/git/BrewDB")
